{
  "schema_version": "1.0.0",
  "project": {
    "name": "AI超级个体开发助手",
    "description": "为超级个体提供从需求到部署的完整人机协作开发闭环",
    "type": "backend",
    "createdAt": "2025-12-14T00:00:00Z"
  },
  "bootstrap": {
    "isBootstrap": true,
    "phase": "规范完善阶段",
    "description": "自举(Bootstrapping)指用系统自身来开发/管理系统本身。当前处于自举准备阶段：先用规范手工管理开发，待工具实现后用工具管理后续开发。",
    "stages": {
      "stage0_preparation": {
        "name": "阶段0：规范准备",
        "status": "in_progress",
        "description": "定义规范、写PRD、准备模板，用手工方式+AI对话管理开发过程",
        "milestones": [
          {
            "id": "m0-1",
            "name": "初始化项目结构",
            "status": "completed",
            "completedAt": "2025-12-14T00:00:00Z",
            "artifacts": [".solodev/", "docs/", "CLAUDE.md", "专项指南"]
          },
          {
            "id": "m0-2",
            "name": "完成7个模块PRD",
            "status": "completed",
            "completedAt": "2025-12-14T00:00:00Z",
            "artifacts": ["docs/PRD/PRD.md", "docs/PRD/modules/*.md"]
          },
          {
            "id": "m0-3",
            "name": "重构PRD模板",
            "status": "completed",
            "completedAt": "2025-12-14T00:00:00Z",
            "artifacts": ["PRD-project-template.md", "PRD-module-template.md"],
            "reason": "发现模板不匹配实际PRD结构（总PRD vs 模块级PRD），需重构为两个模板"
          }
        ]
      },
      "stage1_minimal_tools": {
        "name": "阶段1：最小可用工具",
        "status": "pending",
        "description": "实现核心命令和状态管理，开始用部分工具管理后续开发",
        "milestones": []
      },
      "stage2_self_hosting": {
        "name": "阶段2：自举开始",
        "status": "pending",
        "description": "用第一阶段开发的工具来管理剩余功能的开发",
        "milestones": []
      },
      "stage3_complete_bootstrap": {
        "name": "阶段3：完整自举",
        "status": "pending",
        "description": "用完整工具来优化和重构自己",
        "milestones": []
      }
    },
    "currentStage": "stage0_preparation",
    "nextAction": "进行Architecture设计，按模块依赖顺序：核心流程模型 → 状态管理模块 → 其他模块"
  },
  "currentIteration": "iteration-1",
  "iterations": {
    "iteration-1": {
      "id": "iteration-1",
      "version": "v1.0.0",
      "status": "in_progress",
      "startedAt": "2025-12-14T00:00:00Z",
      "currentPhase": "architecture",
      "phases": {
        "requirements": {
          "status": "approved",
          "startedAt": "2025-12-14T00:00:00Z",
          "approvedAt": "2025-12-14T11:00:00Z",
          "approvedBy": "human",
          "modules": {
            "核心流程模型": {
              "status": "approved",
              "priority": "P0",
              "approvedAt": "2025-12-14T00:00:00Z",
              "artifacts": ["docs/PRD/modules/核心流程模型-PRD.md"],
              "reviewer": "human"
            },
            "状态管理模块": {
              "status": "approved",
              "priority": "P0",
              "approvedAt": "2025-12-14T00:00:00Z",
              "artifacts": ["docs/PRD/modules/状态管理模块-PRD.md"],
              "reviewer": "human"
            },
            "命令体系模块": {
              "status": "approved",
              "priority": "P0",
              "approvedAt": "2025-12-14T00:00:00Z",
              "artifacts": ["docs/PRD/modules/命令体系模块-PRD.md"],
              "reviewer": "human"
            },
            "文档模板模块": {
              "status": "approved",
              "priority": "P0",
              "approvedAt": "2025-12-14T00:00:00Z",
              "artifacts": ["docs/PRD/modules/文档模板模块-PRD.md"],
              "reviewer": "human"
            },
            "影响分析模块": {
              "status": "approved",
              "priority": "P1",
              "approvedAt": "2025-12-14T00:00:00Z",
              "artifacts": ["docs/PRD/modules/影响分析模块-PRD.md"],
              "reviewer": "human"
            },
            "测试验证模块": {
              "status": "approved",
              "priority": "P1",
              "approvedAt": "2025-12-14T00:00:00Z",
              "artifacts": ["docs/PRD/modules/测试验证模块-PRD.md"],
              "reviewer": "human"
            },
            "Git集成模块": {
              "status": "approved",
              "priority": "P0",
              "approvedAt": "2025-12-14T00:00:00Z",
              "artifacts": ["docs/PRD/modules/Git集成模块-PRD.md"],
              "reviewer": "human"
            }
          },
          "currentProcess": {
            "currentModule": null,
            "completedModules": ["核心流程模型", "状态管理模块", "命令体系模块", "文档模板模块", "影响分析模块", "测试验证模块", "Git集成模块"],
            "remainingModules": [],
            "nextAction": "所有模块需求澄清已完成，建议进入architecture阶段"
          }
        },
        "architecture": {
          "status": "in_progress",
          "startedAt": "2025-12-14T11:00:00Z",
          "modules": {
            "核心流程模型": {
              "status": "approved",
              "priority": "P0",
              "approvedAt": "2025-12-14T14:00:00Z",
              "approvedBy": "human",
              "artifacts": [
                "docs/architecture/iteration-1/核心流程模型-00-系统架构总览.md",
                "docs/architecture/iteration-1/核心流程模型-数据模型设计.md",
                "docs/architecture/iteration-1/核心流程模型-集成设计.md"
              ]
            },
            "状态管理模块": {
              "status": "in_progress",
              "priority": "P0",
              "startedAt": "2025-12-14T16:00:00Z",
              "artifacts": [
                "docs/architecture/iteration-1/状态管理模块-00-系统架构总览.md",
                "docs/architecture/iteration-1/状态管理模块-数据模型设计.md",
                "docs/architecture/iteration-1/状态管理模块-集成设计.md"
              ]
            },
            "命令体系模块": {
              "status": "pending",
              "priority": "P0"
            },
            "文档模板模块": {
              "status": "pending",
              "priority": "P0"
            },
            "影响分析模块": {
              "status": "pending",
              "priority": "P1"
            },
            "测试验证模块": {
              "status": "pending",
              "priority": "P1"
            },
            "Git集成模块": {
              "status": "pending",
              "priority": "P0"
            }
          },
          "currentProcess": {
            "currentModule": "状态管理模块",
            "completedModules": ["核心流程模型"],
            "remainingModules": ["状态管理模块", "命令体系模块", "文档模板模块", "影响分析模块", "测试验证模块", "Git集成模块"],
            "nextAction": "设计状态管理模块架构（依赖核心流程模型，已完成）"
          }
        },
        "implementation": {
          "status": "pending",
          "modules": {}
        },
        "testing": {
          "status": "pending",
          "testPhases": {}
        },
        "deployment": {
          "status": "pending"
        }
      }
    }
  },
  "moduleDependencies": {
    "核心流程模型": {
      "dependsOn": [],
      "dependedBy": ["状态管理模块", "命令体系模块", "文档模板模块", "影响分析模块", "测试验证模块"],
      "integrationPoints": [
        {
          "targetModule": "状态管理模块",
          "interface": "getPhaseDefinition(phaseName: string): PhaseDefinition",
          "purpose": "状态管理模块需要获取阶段定义以执行状态流转",
          "dataFlow": "phaseName -> PhaseDefinition",
          "errorHandling": "throw PhaseNotFoundError",
          "complexity": "simple"
        },
        {
          "targetModule": "状态管理模块",
          "interface": "validatePhaseTransition(current, target): ValidationResult",
          "purpose": "验证阶段流转是否合法",
          "dataFlow": "currentPhase + targetPhase -> ValidationResult",
          "errorHandling": "return ValidationResult with errors",
          "complexity": "simple"
        },
        {
          "targetModule": "状态管理模块",
          "interface": "validateStateIntegrity(state): ValidationResult",
          "purpose": "验证state.json的完整性",
          "dataFlow": "State -> ValidationResult",
          "errorHandling": "return ValidationResult with errors",
          "complexity": "simple"
        },
        {
          "targetModule": "命令体系模块",
          "interface": "getPhaseDefinition(phaseName: string): PhaseDefinition",
          "purpose": "命令执行前获取阶段定义判断是否需要审批",
          "dataFlow": "phaseName -> PhaseDefinition",
          "errorHandling": "throw PhaseNotFoundError",
          "complexity": "simple"
        },
        {
          "targetModule": "影响分析模块",
          "interface": "analyzeImpact(module, changeType, deps): ImpactReport",
          "purpose": "影响分析模块调用核心流程模型的影响分析算法",
          "dataFlow": "module + changeType + deps -> ImpactReport",
          "errorHandling": "throw InvalidInputError",
          "complexity": "simple"
        },
        {
          "targetModule": "影响分析模块",
          "interface": "topologicalSort(dependencies): string[]",
          "purpose": "计算模块的拓扑排序结果",
          "dataFlow": "ModuleDependencies -> string[]",
          "errorHandling": "throw CircularDependencyError",
          "complexity": "simple"
        },
        {
          "targetModule": "文档模板模块",
          "interface": "getPhaseDefinition(phaseName: string): PhaseDefinition",
          "purpose": "文档模板模块需要获取阶段定义以填充模板变量",
          "dataFlow": "phaseName -> PhaseDefinition",
          "errorHandling": "throw PhaseNotFoundError",
          "complexity": "simple"
        },
        {
          "targetModule": "测试验证模块",
          "interface": "getPhaseDefinition(phaseName: string): PhaseDefinition",
          "purpose": "测试验证模块需要获取阶段定义以生成测试用例",
          "dataFlow": "phaseName -> PhaseDefinition",
          "errorHandling": "throw PhaseNotFoundError",
          "complexity": "simple"
        }
      ]
    },
    "状态管理模块": {
      "dependsOn": ["核心流程模型"],
      "dependedBy": ["命令体系模块", "影响分析模块", "文档模板模块", "测试验证模块", "Git集成模块"],
      "integrationPoints": [
        {
          "targetModule": "命令体系模块",
          "interface": "readState(): Promise<State>",
          "purpose": "命令执行时读取当前状态",
          "dataFlow": "-> State",
          "errorHandling": "throw StateFileNotFoundError",
          "complexity": "simple"
        },
        {
          "targetModule": "命令体系模块",
          "interface": "updateModuleStatus(phase, module, status): Promise<UpdateResult>",
          "purpose": "���令执行时更新模块状态",
          "dataFlow": "phase + module + status -> UpdateResult",
          "errorHandling": "return UpdateResult with errors",
          "complexity": "simple"
        },
        {
          "targetModule": "命令体系模块",
          "interface": "transitionPhase(target): Promise<TransitionResult>",
          "purpose": "执行阶段流转",
          "dataFlow": "targetPhase -> TransitionResult",
          "errorHandling": "return TransitionResult with errors",
          "complexity": "simple"
        },
        {
          "targetModule": "影响分析模块",
          "interface": "getModuleDependencies(): Promise<ModuleDependencies>",
          "purpose": "获取模块依赖关系进行影响分析",
          "dataFlow": "-> ModuleDependencies",
          "errorHandling": "throw StateFileNotFoundError",
          "complexity": "simple"
        },
        {
          "targetModule": "影响分析模块",
          "interface": "readHistoryIteration(id): Promise<HistoricalIteration>",
          "purpose": "读取历史迭代进行对比分析",
          "dataFlow": "iterationId -> HistoricalIteration",
          "errorHandling": "throw HistoryNotFoundError",
          "complexity": "simple"
        },
        {
          "targetModule": "文档模板模块",
          "interface": "readState(): Promise<State>",
          "purpose": "读取状态填充模板变量",
          "dataFlow": "-> State",
          "errorHandling": "throw StateFileNotFoundError",
          "complexity": "simple"
        },
        {
          "targetModule": "测试验证模块",
          "interface": "updateTestSubPhaseStatus(subPhase, status): Promise<UpdateResult>",
          "purpose": "更新Testing子阶段状态",
          "dataFlow": "subPhase + status -> UpdateResult",
          "errorHandling": "return UpdateResult with errors",
          "complexity": "simple"
        },
        {
          "targetModule": "Git集成模块",
          "interface": "updateGitMetadata(hash, message): Promise<void>",
          "purpose": "更新Git相关元数据",
          "dataFlow": "hash + message -> void",
          "errorHandling": "throw Error",
          "complexity": "simple"
        }
      ]
    },
    "命令体系模块": {
      "dependsOn": ["核心流程模型", "状态管理模块"],
      "dependedBy": []
    },
    "文档模板模块": {
      "dependsOn": ["核心流程模型"],
      "dependedBy": []
    },
    "影响分析模块": {
      "dependsOn": ["核心流程模型", "状态管理模块"],
      "dependedBy": []
    },
    "测试验证模块": {
      "dependsOn": ["核心流程模型"],
      "dependedBy": []
    },
    "Git集成模块": {
      "dependsOn": ["核心流程模型"],
      "dependedBy": []
    }
  },
  "globalTasks": {
    "pending": [],
    "completed": [
      {
        "id": "task-001",
        "title": "确认是否进入architecture阶段",
        "description": "所有模块需求澄清已完成，需确认是否进入架构设计阶段",
        "priority": "P0",
        "createdAt": "2025-12-14T00:00:00Z",
        "completedAt": "2025-12-14T11:00:00Z",
        "resolution": "用户接受选项B，进入Architecture阶段"
      }
    ]
  },
  "changeHistory": [
    {
      "timestamp": "2025-12-14T00:00:00Z",
      "type": "init",
      "description": "初始化项目状态",
      "changedBy": "ai",
      "changes": [
        {
          "field": "currentIteration",
          "from": null,
          "to": "iteration-1"
        },
        {
          "field": "phases.requirements.status",
          "from": null,
          "to": "in_progress"
        }
      ]
    },
    {
      "timestamp": "2025-12-14T10:00:00Z",
      "type": "bootstrap",
      "description": "添加bootstrap字段，记录自举过程的4个阶段和已完成的3个里程碑",
      "changedBy": "ai",
      "changes": [
        {
          "field": "bootstrap",
          "from": null,
          "to": "added (stage0_preparation in_progress, 3 milestones completed)"
        },
        {
          "field": "templates",
          "from": "PRD-backend-template.md (单模板)",
          "to": "PRD-project-template.md + PRD-module-template.md (双模板)"
        }
      ]
    },
    {
      "timestamp": "2025-12-14T11:00:00Z",
      "type": "phase_transition",
      "description": "Requirements阶段完成并审批通过，进入Architecture阶段",
      "changedBy": "human",
      "changes": [
        {
          "field": "phases.requirements.status",
          "from": "in_progress",
          "to": "approved"
        },
        {
          "field": "phases.architecture.status",
          "from": "pending",
          "to": "in_progress"
        },
        {
          "field": "currentPhase",
          "from": null,
          "to": "architecture"
        },
        {
          "field": "globalTasks.pending",
          "from": "1 task",
          "to": "0 tasks (task-001 completed)"
        }
      ],
      "decision": "用户接受选项B（进入Architecture阶段），严格遵循规范流程：requirements → architecture → implementation"
    },
    {
      "timestamp": "2025-12-14T14:00:00Z",
      "type": "module_completed",
      "description": "完成核心流程模型架构设计并审批通过",
      "changedBy": "ai",
      "changes": [
        {
          "field": "phases.architecture.modules.核心流程模型.status",
          "from": "pending",
          "to": "approved"
        },
        {
          "field": "phases.architecture.modules.核心流程模型.artifacts",
          "from": null,
          "to": "3 architecture documents (系统架构总览、数据模型设计、集成设计)"
        },
        {
          "field": "phases.architecture.currentProcess.completedModules",
          "from": "[]",
          "to": "[核心流程模型]"
        },
        {
          "field": "moduleDependencies.核心流程模型.integrationPoints",
          "from": null,
          "to": "8 integration points (与5个模块的集成)"
        }
      ],
      "artifacts": [
        "docs/architecture/iteration-1/核心流程模型-00-系统架构总览.md",
        "docs/architecture/iteration-1/核心流程模型-数据模型设计.md",
        "docs/architecture/iteration-1/核心流程模型-集成设计.md"
      ],
      "notes": "核心流程模型作为元模型层,定义了五阶段流转规则、状态机、依赖解析算法、影响分析算法和7类数据完整性约束"
    },
    {
      "timestamp": "2025-12-14T15:00:00Z",
      "type": "architecture_supplement",
      "description": "根据架构评审反馈，补充核心流程模型架构设计（5项遗漏问题）",
      "changedBy": "ai",
      "reviewFeedback": [
        "问题1: 分层分析算法缺失 - 已补充RootCauseAnalysisFramework完整定义",
        "问题2: Testing子阶段未体现 - 已补充TestingPhaseState和TestSubPhaseState",
        "问题3: 回滚状态处理不明确 - 已补充rolled_back状态和RollbackRule",
        "问题4: changeHistory职责归属不清 - 已明确由状态管理模块负责",
        "问题5: 算法接口未定义 - 已补充determineImpactedPhases和calculateEffort"
      ],
      "changes": [
        {
          "field": "数据模型设计.第十一节",
          "from": null,
          "to": "补充设计（Testing子阶段状态机、rolled_back状态、分层分析框架、算法实现）"
        },
        {
          "field": "集成设计.第九节",
          "from": null,
          "to": "补充设计（算法接口扩展、配置接口扩展、changeHistory职责归属）"
        }
      ],
      "artifacts": [
        "docs/architecture/iteration-1/核心流程模型-数据模型设计.md (第十一节)",
        "docs/architecture/iteration-1/核心流程模型-集成设计.md (第九节)"
      ]
    },
    {
      "timestamp": "2025-12-14T16:00:00Z",
      "type": "module_completed",
      "description": "完成状态管理模块架构设计，待用户审批",
      "changedBy": "ai",
      "changes": [
        {
          "field": "phases.architecture.modules.状态管理模块.status",
          "from": "pending",
          "to": "in_progress"
        },
        {
          "field": "phases.architecture.modules.状态管理模块.artifacts",
          "from": null,
          "to": "3 architecture documents (系统架构总览、数据模型设计、集成设计)"
        },
        {
          "field": "moduleDependencies.状态管理模块.integrationPoints",
          "from": null,
          "to": "8 integration points (与5个模块的集成)"
        }
      ],
      "artifacts": [
        "docs/architecture/iteration-1/状态管理模块-00-系统架构总览.md",
        "docs/architecture/iteration-1/状态管理模块-数据模型设计.md",
        "docs/architecture/iteration-1/状态管理模块-集成设计.md"
      ],
      "notes": "状态管理模块作为数据中枢，采用分层架构(API→Service→Repository→IO)，提供统一的状态读写接口，自动维护changeHistory，与核心流程模型紧密集成进行状态验证"
    }
  ],
  "settings": {
    "autoReadHistory": true,
    "requireApprovalForPhaseTransition": true
  },
  "metadata": {
    "lastGitCommit": "9825b14",
    "lastGitCommitMessage": "docs(architecture): 补充核心流程模型架构设计",
    "lastGitCommitAt": "2025-12-14T15:00:00Z",
    "stateFileVersion": 9,
    "totalStateChanges": 9,
    "lastUpdatedAt": "2025-12-14T16:00:00Z",
    "lastUpdatedBy": "ai"
  },
  "templateVersions": {
    "PRD_project": "1.0.0",
    "PRD_module": "1.0.0",
    "architecture": "1.0.0",
    "testing": "1.0.0",
    "deployment": "1.0.0"
  }
}
